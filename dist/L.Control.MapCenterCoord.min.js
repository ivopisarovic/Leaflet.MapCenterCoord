/* Leaflet.MapCenterCoord
https://github.com/xguaita/Leaflet.MapCenterCoord
Version: 0.7.0 - Date: 2019-11-25 */
L.Control.MapCenterCoord=L.Control.extend({options:{position:"bottomleft",icon:!0,onMove:!1,template:"{y} | {x}",projected:!1,formatProjected:"#.##0,000",latlngFormat:"DD",latlngDesignators:!1,latLngFormatter:void 0},onAdd:function(a){return this.options.icon&&(this._iconEl=L.DomUtil.create("div","leaflet-control-mapcentercoord-icon leaflet-zoom-hide"),a.getPanes().overlayPane.appendChild(this._iconEl),a.on("viewreset",this._onReset,this),this._onReset()),this._container=L.DomUtil.create("div","leaflet-control-mapcentercoord"),L.DomEvent.disableClickPropagation(this._container),a.on("move",this._onMapMove,this),a.on("moveend",this._onMapMoveEnd,this),this._container.innerHTML=this._getMapCenterCoord(),this._container},onRemove:function(a){this.options.icon&&(a.getPanes().overlayPane.removeChild(this._iconEl),a.off("viewreset",this._onReset,this)),a.off("move",this._onMapMove,this),a.off("moveend",this._onMapMove,this)},_onReset:function(){var a=this._map.latLngToLayerPoint(this._map.getCenter());L.DomUtil.setPosition(this._iconEl,a)},_onMapMove:function(){if(this.options.icon){var a=this._map.latLngToLayerPoint(this._map.getCenter());L.DomUtil.setPosition(this._iconEl,a)}this.options.onMove&&(this._container.innerHTML=this._getMapCenterCoord())},_onMapMoveEnd:function(){if(this.options.icon){var a=this._map.latLngToLayerPoint(this._map.getCenter());L.DomUtil.setPosition(this._iconEl,a)}this._container.innerHTML=this._getMapCenterCoord()},_getMapCenterCoord:function(){return this.options.projected?this._getProjectedCoord(this._map.options.crs.project(this._map.getCenter())):this._getLatLngCoord(this._map.getCenter())},_getProjectedCoord:function(a){return L.Util.template(this.options.template,{x:this._format(this.options.formatProjected,a.x),y:this._format(this.options.formatProjected,a.y)})},_getLatLngCoord:function(a){if(void 0!=this.options.latLngFormatter)return this.options.latLngFormatter(a.lat,a.lng);var b,c,d,e,f={lat:a.lat,lng:a.lng};return f.lng<0?(f.lng_neg=!0,f.lng=Math.abs(f.lng)):f.lng_neg=!1,f.lat<0?(f.lat_neg=!0,f.lat=Math.abs(f.lat)):f.lat_neg=!1,f.lng>180&&(f.lng=360-f.lng,f.lng_neg=!f.lng_neg),"DM"===this.options.latlngFormat?(d=parseInt(f.lng),c=d+"º "+this._format("00.000",60*(f.lng-d))+"'",d=parseInt(f.lat),b=d+"º "+this._format("00.000",60*(f.lat-d))+"'"):"DMS"===this.options.latlngFormat?(d=parseInt(f.lng),e=60*(f.lng-d),c=d+"º "+this._format("00",parseInt(e))+"' "+this._format("00.0",60*(e-parseInt(e)))+"''",d=parseInt(f.lat),e=60*(f.lat-d),b=d+"º "+this._format("00",parseInt(e))+"' "+this._format("00.0",60*(e-parseInt(e)))+"''"):(c=this._format("#0.00000",f.lng)+"º",b=this._format("##0.00000",f.lat)+"º"),L.Util.template(this.options.template,{x:(!this.options.latlngDesignators&&f.lng_neg?"-":"")+c+(this.options.latlngDesignators?f.lng_neg?" W":" E":""),y:(!this.options.latlngDesignators&&f.lat_neg?"-":"")+b+(this.options.latlngDesignators?f.lat_neg?" S":" N":"")})},_format:function(a,b){if(!a||isNaN(+b))return b;var b="-"==a.charAt(0)?-b:+b,c=0>b?b=-b:0,d=a.match(/[^\d\-\+#]/g),e=d&&d[d.length-1]||".",f=d&&d[1]&&d[0]||",",a=a.split(e);b=b.toFixed(a[1]&&a[1].length),b=+b+"";var g=a[1]&&a[1].lastIndexOf("0"),h=b.split(".");(!h[1]||h[1]&&h[1].length<=g)&&(b=(+b).toFixed(g+1));var i=a[0].split(f);a[0]=i.join("");var j=a[0]&&a[0].indexOf("0");if(j>-1)for(;h[0].length<a[0].length-j;)h[0]="0"+h[0];else 0==+h[0]&&(h[0]="");b=b.split("."),b[0]=h[0];var k=i[1]&&i[i.length-1].length;if(k){for(var l=b[0],m="",n=l.length%k,o=0,p=l.length;p>o;o++)m+=l.charAt(o),!((o-n+1)%k)&&p-k>o&&(m+=f);b[0]=m}return b[1]=a[1]&&b[1]?e+b[1]:"",(c?"-":"")+b[0]+b[1]}}),L.Map.mergeOptions({MapCenterCoordControl:!1}),L.Map.addInitHook(function(){this.options.MapCenterCoordControl&&(this.MapCenterCoordControl=new L.Control.MapCenterCoord,this.addControl(this.MapCenterCoordControl))}),L.control.mapCenterCoord=function(a){return new L.Control.MapCenterCoord(a)};